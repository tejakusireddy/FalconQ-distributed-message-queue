graph TD
  subgraph Clients
    Producer["ğŸŸ¢ Producer\n(POST /publish)"]
    Consumer["ğŸŸ  Consumer\n(GET /subscribe)"]
  end

  subgraph Gateway
    API["ğŸšª FastAPI Gateway\n(Routing + LLM Dispatch)"]
  end

  subgraph Core
    LB["ğŸ” gRPC Load Balancer"]
    Broker1["ğŸ§± Broker Node 1\n(Go, Raft, RocksDB)"]
    Broker2["ğŸ§± Broker Node 2\n(Go, Raft, RocksDB)"]
    Broker3["ğŸ§± Broker Node 3\n(Go, Raft, RocksDB)"]
  end

  subgraph Infra
    Redis["ğŸ§  Redis\n(Offsets/Metadata)"]
    RocksDB1["ğŸ’¾ RocksDB"]
    RocksDB2["ğŸ’¾ RocksDB"]
    RocksDB3["ğŸ’¾ RocksDB"]
    LLM["ğŸ¤– LLM Worker\n(Python + OpenAI)"]
    Prometheus["ğŸ“ˆ Prometheus"]
    Grafana["ğŸ“Š Grafana Dashboard"]
    OTLP["ğŸ” OpenTelemetry + Tempo"]
  end

  Producer --> API
  Consumer --> API
  API --> LB
  LB --> Broker1
  LB --> Broker2
  LB --> Broker3

  Broker1 --> RocksDB1
  Broker2 --> RocksDB2
  Broker3 --> RocksDB3

  API --> LLM
  Broker1 --> Redis
  Broker2 --> Redis
  Broker3 --> Redis

  Broker1 --> Prometheus
  Broker2 --> Prometheus
  Broker3 --> Prometheus

  Prometheus --> Grafana
  API --> OTLP
  LB --> OTLP
  LLM --> OTLP
  OTLP --> Grafana
